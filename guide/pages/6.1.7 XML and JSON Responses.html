<html>
     <head>
     	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
     	<title>6.1.7 XML and JSON Responses</title>
     	<link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8">
     </head>
	<body class="body">
		<h4>Using the render method to output XML(render 메소드를 이용하여 XML 형식으로 응답하기)</h4><p class="paragraph"/>Grails가 XML과 JSON 형식으로 응답할 수 있도록 제공하는 방법은 여러가지다. 먼저 <a href="../ref/Controllers/render.html" class="controllers">render</a> 메소드를 사용하는 법부터 알아보자:<p class="paragraph"/>XML을 생성하는 코드의 블럭을 <code>render</code> 메소드에 넘길 수 있다:<p class="paragraph"/><div class="code"><pre>def list = &#123;
	def results = Book.list()
	render(contentType:<span class="java&#45;quote">"text/xml"</span>) &#123;
		books &#123;
			<span class="java&#45;keyword">for</span>(b in results) &#123;
				book(title:b.title)
			&#125;
		&#125;	
	&#125;
&#125;</pre></div><p class="paragraph"/>이 코드의 결과는 다음과 같을 것이다:<p class="paragraph"/><div class="code"><pre><span class="xml&#45;tag">&#60;books&#62;</span>
	  <span class="xml&#45;tag">&#60;book title=<span class="xml&#45;quote">"The Stand"</span> /&#62;</span>
	  <span class="xml&#45;tag">&#60;book title=<span class="xml&#45;quote">"The Shining"</span> /&#62;</span>	
<span class="xml&#45;tag">&#60;/books&#62;</span></pre></div><p class="paragraph"/>마크업을 만들 때 이름이 중복되지 않도록 주의해야 한다. 예를 들어 다음과 같은 코드는 오류가 발생한다:<p class="paragraph"/><div class="code"><pre>def list = &#123;
	def books = Book.list()  // 변수 이름이 중복됐다
		render(contentType:<span class="java&#45;quote">"text/xml"</span>) &#123;
		books &#123;
			<span class="java&#45;keyword">for</span>(b in results) &#123;
				book(title:b.title)
			&#125;
		&#125;	
	&#125;
&#125;</pre></div><p class="paragraph"/>Groovy에서는 지역 변수 <code>books</code>를 메소드처럼 실행하려고 하기 때문이다<p class="paragraph"/><h4>Using the render method to output JSON(render 메소드를 이용하여 JSON형식으로 응답하기)</h4><p class="paragraph"/><code>render</code> 메소드를 사용하여 JSON형식으로도 출력할 수 있다:<p class="paragraph"/><div class="code"><pre>def list = &#123;
	def results = Book.list()
	render(contentType:<span class="java&#45;quote">"text/json"</span>) &#123;
		books &#123;
			<span class="java&#45;keyword">for</span>(b in results) &#123;
				book(title:b.title)
			&#125;
		&#125;	
	&#125;
&#125;</pre></div><p class="paragraph"/>이 결과는 다음과 같다:<p class="paragraph"/><div class="code"><pre>&#91;
	&#123;title:<span class="java&#45;quote">"The Stand"</span>&#125;, 
	&#123;title:<span class="java&#45;quote">"The Shining"</span>&#125;
&#93;</pre></div><p class="paragraph"/>JSON을 만들 때에도 이름이 중복되지 않게 해야 한다.<p class="paragraph"/><h4>Automatic XML Marshalling(자동 XML 마샬링)</h4><p class="paragraph"/>Grails에는 특수한 변환기를 이용해 자동으로 <a href="../guide/single.html#5. Object Relational Mapping (GORM)" class="guide">domain classes</a>를 XML 마샬링하는 기능이 있다.<p class="paragraph"/>컨트롤러에 <code>grails.converters</code> 패키지를 import한다.<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.converters.&#42;</pre></div><p class="paragraph"/>다음과 같이 굉장히 간편한 문법으로 도메인 클래스를 XML로 변환할 수 있다:<p class="paragraph"/><div class="code"><pre>render Book.list() as XML</pre></div><p class="paragraph"/>이 결과는 다음과 같다:<p class="paragraph"/><div class="code"><pre>&#60;?xml version=<span class="java&#45;quote">"1.0"</span> encoding=<span class="java&#45;quote">"ISO&#45;8859&#45;1"</span>?&#62;
&#60;list&#62;
  &#60;book id=<span class="java&#45;quote">"1"</span>&#62;
    &#60;author&#62;Stephen King&#60;/author&#62;
    &#60;title&#62;The Stand&#60;/title&#62;
  &#60;/book&#62;
  &#60;book id=<span class="java&#45;quote">"2"</span>&#62;
    &#60;author&#62;Stephen King&#60;/author&#62;
    &#60;title&#62;The Shining&#60;/title&#62;
  &#60;/book&#62;
&#60;/list&#62;</pre></div><p class="paragraph"/>Grails의 코덱(<a href="../guide/single.html#11.2 Encoding and Decoding Strings" class="guide">codecs</a>) 기능을 사용하도록 변환기를 사용할 수도 있다. 이 코덱 기능으로 <a href="../guide/single.html#11.2 Encoding and Decoding Strings" class="guide">encodeAsXML</a>과 <a href="../guide/single.html#11.2 Encoding and Decoding Strings" class="guide">encodeAsJSON</a> 메소드를 제공한다:<p class="paragraph"/><div class="code"><pre>def xml = Book.list().encodeAsXML()
render xml</pre></div><p class="paragraph"/>XML 마샬링에 대한 내용은 <a href="../guide/single.html#13.1 REST" class="guide">REST</a>를 설명하는 절에서도 볼 수 있다.<p class="paragraph"/><h4>Automatic JSON Marshalling(자동 JSON 마샬링)</h4><p class="paragraph"/>Grails는 자동으로 JSON을 마샬링해주는 방법도 제공한다. XML 마샬링의 방법과 동일하다. 단지 <code>XML</code>을 <code>JSON</code>으로 바꾸기만 하면 된다.<p class="paragraph"/><div class="code"><pre>render Book.list() as JSON</pre></div><p class="paragraph"/>이 결과는 다음과 같다:<p class="paragraph"/><div class="code"><pre>&#91;
	&#123;<span class="java&#45;quote">"id"</span>:1,
	 <span class="java&#45;quote">"class"</span>:<span class="java&#45;quote">"Book"</span>,
	 <span class="java&#45;quote">"author"</span>:<span class="java&#45;quote">"Stephen King"</span>,
	 <span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"The Stand"</span>&#125;,
	&#123;<span class="java&#45;quote">"id"</span>:2,
	 <span class="java&#45;quote">"class"</span>:<span class="java&#45;quote">"Book"</span>,
	 <span class="java&#45;quote">"author"</span>:<span class="java&#45;quote">"Stephen King"</span>,
	 <span class="java&#45;quote">"releaseDate"</span>:<span class="java&#45;keyword">new</span> Date(1194127343161),
	 <span class="java&#45;quote">"title"</span>:<span class="java&#45;quote">"The Shining"</span>&#125;
 &#93;</pre></div><p class="paragraph"/>XML 마샬링처럼 <code>encodeAsJSON</code> 메소드를 사용할 수도 있다.

	</body>
</html>