<html>
     <head>
     	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
     	<title>Grails Reference</title>
     	<link rel="stylesheet" href="../../css/ref.css" type="text/css" media="screen" title="Ref" charset="utf-8">
     </head>
	<body class="body">
		<h1>withFormat </h1><p class="paragraph"/><h2>Purpose</h2><p class="paragraph"/>Used to execute different responses based on the incoming request <code>Accept</code> header, format parameter or URI extension. See <a href="../../guide/single.html#6.8 Content Negotiation" class="guide">content negotiation</a> for more information.<p class="paragraph"/><h2>Examples</h2><p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">import</span> grails.converters.&#42;<p class="paragraph"/>class BookController &#123;
	def books
	def list = &#123;
		<span class="java&#45;keyword">this</span>.books = Book.list()
		withFormat &#123;
			html bookList:books
			js &#123; render <span class="java&#45;quote">"alert('hello')"</span> &#125; 
			xml &#123; render books as XML &#125;
		&#125;
	&#125;
&#125;</pre></div><p class="paragraph"/><h2>Description</h2><p class="paragraph"/>The <code>withFormat</code> method takes a block within the scope of which you can execute different methods whose names match the content type you want to respond to. For example:<p class="paragraph"/><div class="code"><pre>withFormat &#123;
	html bookList:books
	js &#123; render <span class="java&#45;quote">"alert('hello')"</span> &#125; 
	xml &#123; render books as XML &#125;
&#125;</pre></div><p class="paragraph"/>Here we invoke three methods called <code>html</code>, <code>js</code> and <code>xml</code> that use mime type names configured in <code>grails-app/conf/Config.groovy</code> (See <a href="../../guide/single.html#6.8 Content Negotiation" class="guide">content negotiation</a> for more information). The call to <code>html</code> accepts a model (a map) which is passed on to the view. Grails will first search for a view called <code>grails-app/views/book/list.html.gsp</code> and if that is not found fallback to <code>grails-app/views/book/list.gsp</code>.<p class="paragraph"/>If you require the model the be lazily executed you can pass a closure or block instead of a map:<p class="paragraph"/><div class="code"><pre>withFormat &#123;
	html &#123; &#91;bookList:Book.list()&#93; &#125;
    &#8230;
&#125;</pre></div><p class="paragraph"/>The block will only get executed if the <code>html</code> format is matched. 

	</body>
</html>